<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wyszukiwarka planogramów</title>
    <style>
        /* Twój styl pozostaje bez zmian */
    </style>
</head>
<body>

<h2>Wyszukiwarka planogramów</h2>

<!-- Usunięcie przycisku skanera -->
<input type="text" id="searchInput" placeholder="Wprowadź dane">
<button id="searchButton" onclick="searchData()">Wyszukaj</button>

<h3>Wyniki wyszukiwania:</h3>

<div id="resultContainer"></div>
<script src="https://cdn.rawgit.com/serratus/quaggaJS/0.12.1/dist/quagga.min.js"></script>
<script>
    function searchData() {
        var searchInput = document.getElementById('searchInput').value;

        // Sprawdzenie, czy podano dane do wyszukania
        if (searchInput.trim() === "") {
            // Wyświetlanie komunikatu o braku danych
            document.getElementById('resultContainer').innerHTML = '<p class="no-results">Brak danych.</p>';
            return;
        }

        var apiKey = 'AIzaSyD0DTyPWSFIAalWvehONn1kFbkNqKyyDdU';
        var sheetId = '1AVm0KiZJQ4YFjc0D4N49upOopz4x1CjeKpuJQYggsH4';

        // Czyszczenie poprzednich wyników
        var resultContainer = document.getElementById('resultContainer');
        resultContainer.innerHTML = '';

        // Czyszczenie pola do wprowadzania danych
        document.getElementById('searchInput').value = '';

        // Tworzenie żądania do Google Sheets API
        var url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/Arkusz1?key=${apiKey}`;
        fetch(url)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Błąd: ${response.status} - ${response.statusText}`);
                }
                return response.json();
            })
            .then(data => {
                if (!data || !data.values) {
                    throw new Error('Błąd: Brak danych lub błąd w odpowiedzi API.');
                }

                var rows = data.values;

                // Szukanie pasujących danych w kolumnie "D,E"
                for (var i = 0; i < rows.length; i++) {
                    // Sprawdzanie, czy indeks komórki istnieje i czy zawiera dane
                    if ((rows[i][0] && rows[i][0].toLowerCase() === searchInput.toLowerCase()) ||
                        (rows[i][1] && rows[i][1].toLowerCase() === searchInput.toLowerCase())) {
                        // Tworzenie tabeli
                        var table = document.createElement('table');

                        // Określanie kolejności wyświetlanych kolumn
                        var columnOrder = [0, 1, 2, 3];

                        // Dodawanie wierszy z danymi
                        for (var j = 0; j < columnOrder.length; j++) {
                            var row = table.insertRow(j);
                            var headerCell = row.insertCell(0);
                            var dataCell = row.insertCell(1);
                            headerCell.textContent = data.values[0][columnOrder[j]];
                            // Sprawdzanie, czy indeks komórki istnieje i czy zawiera dane
                            dataCell.textContent = rows[i][columnOrder[j]] || 'Brak danych';

                            // Dodanie efektu podświetlenia przemiennie
                            if (j % 2 === 0) {
                                row.classList.add('highlight-even');
                            } else {
                                row.classList.add('highlight-odd');
                            }
                        }

                        // Dodawanie tabeli do wyniku
                        resultContainer.appendChild(table);
                    }
                }

                // Obsługa braku wyników
                if (resultContainer.children.length === 0) {
                    resultContainer.innerHTML = '<p class="no-results">Brak pasujących wyników.</p>';
                }
            })
            .catch(error => {
                // Obsługa błędu i wyświetlanie powiadomienia
                resultContainer.innerHTML = `<p class="error-message">Błąd: ${error.message}</p>`;
            });
    }
</script>

</body>
</html>
